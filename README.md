### README - AIレシート一括処理

このツールは、openAIのAPIを使って、レシート読み取り(仕分け)を行うプログラムです。具体的には、指定されたフォルダ内のレシート画像から情報を抽出し、結果をテキストファイルに保存します。

特徴としては、openAIの頭のいいAIを使っているので、誰でも日本語で指定して自由なフォーマットの取り込みができることです。かかる費用は、処理したレシートの枚数x1円くらい？なのでお財布にもやさしめ

想定としては、ワンドライブ等のクラウドサービスに月毎フォルダをほってレシート/領収書の画像をアップロードしておき、月末にこのスクリプトを実行、です！クラウドサービスはローカルにも画像が同期されるので、入力するフォルダのパスはローカルのパスを入力してください

#### システム要件
- Python 3.8 以上
- requirements.txtに記載されているモジュール
- インターネット接続（OpenAI APIへのアクセスが必要）

#### 準備方法
1. Pythonをインストールしrequirements.txtから必要なライブラリをインストールします（これがわからない人はexeを実行）
2. OpenAIのAPIキーを予め取得しておく(やり方は検索して調べてね)

#### 使用方法
1. `main.py` を実行　あるいは 領収書処理.bat　あるいはexeを実行します
   ```bash
   python main.py
   ```
2. GUIが開くので、OpenAIのAPIキーを下部のウィンドウに入力（ファイル閉じた後もsettings.jsonとして保存されます）
3. 「選択」ボタンをクリックして、レシート画像が保存されているフォルダを選択します。
4. 「処理開始」ボタンをクリックして、画像の処理を開始します（時間かかります！）。
5. 処理が完了すると、選択したフォルダに `results.txt/csv` ファイルが生成され、抽出された情報が保存されます。エラーが発生した場合は、同フォルダに `error_log.txt` ファイルが生成されます。

#### 出力フォーマット
抽出されたデータは以下のような形式で `results.txt` `results.csv`に保存されます。
```
IMG_2853.jpg, 2024/05/12,ショップA,雑貨,4505,消耗品費
IMG_XXX(略)
```
**抜き出す情報は簡単にカスタムできます！**
詳細設定ボタンを押すと、AIにお願いしている文章が入っているので、自分が欲しいものに書き換えればOKです！カンマ区切りがいやなら、スラッシュ区切りにしたり、消費税の情報を追加したり、自由にカスタマイズができます。

#### 注意事項
- このツールは `.jpg` および `.png` 形式の画像ファイルのみをサポートしています。
- 情報の機密性については、API経由でAIとやりとりするので、入力した情報が学習に使われたり、漏洩することはありません。
- APIの使用料が発生しますので使用前にOpenAIの料金体系を確認してください。また、処理費用が高くなりすぎないように、画像のリサイズ処理を入れています。詳細設定から変更も可能です（デフォは1800で、これで処理一枚につき1円くらい）
- APIkeyは　settings.json内に保存されますので、不特定多数が触るPCでは必ずファイルを消してください
- Pythonわからないよっていう人向けに、exeファイルがdistフォルダの中に入っている！けど起動すごく重いので注意。自力でExe作る方法は、pyinstaller --onefile --windowed main.py
- ど素人がAIに作ってもらったツールなので不備あるかも

#### 参考にしたページ
https://qiita.com/miso_taku/items/559f771b5b259a2f7bd7
