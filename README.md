### README - レシート画像から情報抽出ツール

このツールは、openAIのAPIを使って、指定されたフォルダ内のレシート画像から情報を抽出し、結果をテキストファイルに保存します。
想定としては、ワンドライブに月毎のフォルダをほって、領収書の画像をアップロードしておき、月末にこのスクリプトを実行する想定です！ワンドライブはローカルに同期されるので、入力するフォルダのパスはローカルのパスを入力してください

#### システム要件
- Python 3.8 以上
- openAI Python ライブラリ
- インターネット接続（OpenAI APIへのアクセスが必要）

#### セットアップ方法
1. 必要なライブラリをインストールします。
   ```bash
   pip install openai
   ```
2. OpenAIのAPIキーを取得し、`secret.json` ファイルを作って保存します。
   ```json
   {
       "OPENAI_API_KEY": "ここにAPIキーを入力"
   }
   ```
3. Batを使いたい人は、領収書処理(パス書き換えてね).batをテキストエディタで開いてパスを修正して上書き

#### 使用方法
1. `main.py` を実行　あるいは 領収書処理.batを実行します
   ```bash
   python main.py
   ```
2. GUIが開くので、「フォルダ選択」ボタンをクリックして、画像が保存されているフォルダを選択します。
3. 「画像処理開始」ボタンをクリックして、画像の処理を開始します。
4. 処理が完了すると、選択したフォルダに `results.txt` ファイルが生成され、抽出された情報が保存されます。エラーが発生した場合は、同フォルダに `error_log.txt` ファイルが生成されます。

#### 出力フォーマット
抽出されたデータは以下の形式で `results.txt` に保存されます。
```
IMG_2853.jpg, 2024/05/12,ショップA,雑貨,4505,消耗品費
IMG_XXX(略)
```
**抜き出す情報は簡単にカスタムできます！**
text_extractor.pyを開いて、このようなプロンプト部分を自分のすきなように書き換えればOK↓
```
    PROMPT_TEMPLATE = "画像から、取引年月日(yyyy/mm/ddのみ時間なし)、店舗名、合計金額(通貨記号は削除)を抽出しカンマ区切り(,)でreturnせよ"
```

#### 注意事項
- このツールは `.jpg` および `.png` 形式の画像ファイルのみをサポートしています。
- APIの使用料が発生する可能性があるため、使用前にOpenAIの料金体系を確認してください。gpt4-oだからかなり安いですが…
- exeファイルはdistフォルダの中に入っているけど遅いです

#### 参考にしたページ
https://qiita.com/miso_taku/items/559f771b5b259a2f7bd7
