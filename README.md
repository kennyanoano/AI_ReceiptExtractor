### README - レシート画像から情報抽出ツール

このツールは、openAIのAPIを使って、指定されたフォルダ内のレシート画像から情報を抽出し、結果をテキストファイルに保存します。

想定としては、ワンドライブに月毎のフォルダをほって、領収書の画像をアップロードしておき、月末にこのスクリプトを実行する想定です！ワンドライブはローカルに同期されるので、入力するフォルダのパスはローカルのパスを入力してください

#### システム要件
- Python 3.8 以上
- requirements.txtに記載されているモジュール
- インターネット接続（OpenAI APIへのアクセスが必要）

#### 準備方法
1. Pythonをインストールしrequirements.txtから必要なライブラリをインストールします（これがわからない人はexe実行）
2. OpenAIのAPIキーを予め取得しておく(やり方は検索して調べてね)

#### 使用方法
1. `main.py` を実行　あるいは 領収書処理.bat　あるいはexeを実行します
   ```bash
   python main.py
   ```
2. OpenAIのAPIキーを下部のウィンドウに入力（ファイル閉じた後もsettings.jsonとして保存されます）
2. GUIが開くので、「フォルダ選択」ボタンをクリックして、画像が保存されているフォルダを選択します。
3. 「画像処理開始」ボタンをクリックして、画像の処理を開始します。
4. 処理が完了すると、選択したフォルダに `results.txt` ファイルが生成され、抽出された情報が保存されます。エラーが発生した場合は、同フォルダに `error_log.txt` ファイルが生成されます。

#### 出力フォーマット
抽出されたデータは以下の形式で `results.txt` に保存されます。
```
IMG_2853.jpg, 2024/05/12,ショップA,雑貨,4505,消耗品費
IMG_XXX(略)
```
**抜き出す情報は簡単にカスタムできます！**
text_extractor.pyを開いて、このようなプロンプト部分を自分のすきなように書き換えればOK↓
```
    PROMPT_TEMPLATE = "画像から、取引年月日(yyyy/mm/ddのみ時間なし)、店舗名、合計金額(通貨記号は削除)を抽出しカンマ区切り(,)でreturnせよ"
```

#### 注意事項
- このツールは `.jpg` および `.png` 形式の画像ファイルのみをサポートしています。
- APIの使用料が発生しますので使用前にOpenAIの料金体系を確認してください。心配だったら少数で一回まわして費用を確認してください。gpt4-oだからかなり安いですが…(一枚10円いかない？)
- APIkeyは　settings.json内に保存されますので、不特定多数が触るPCでは消してください
- Pythonとかわからないよっていう人向けに、exeファイルがdistフォルダの中に入っている！けど起動すごく重いので注意。自力でExe作る方法は、pyinstaller --onefile --windowed main.py
- ど素人がAIに作ってもらったツールなので不備あるかも

#### 参考にしたページ
https://qiita.com/miso_taku/items/559f771b5b259a2f7bd7

